<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Access Pass Generation - MEMBRO Security</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon"><img src="../logo.png" alt="MEMBRO Logo"></div>
                    <div class="logo-text">
                        <h1>MEMBRO</h1>
                        <span>Security Portal</span>
                    </div>
                </div>
                <div class="user-info">
                    <div class="user-details">
                        <span class="user-name">Officer Rodriguez</span>
                        <span class="user-unit">Security Team</span>
                    </div>
                    <div class="user-avatar">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                </div>
            </div>
        </header>

        <nav class="sidebar">
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="visitor-log.html" class="nav-link">
                        <i class="fas fa-clipboard-list"></i>
                        <span>Visitor Log</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="entry-exit.html" class="nav-link">
                        <i class="fas fa-door-open"></i>
                        <span>Entry/Exit</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="access-pass.html" class="nav-link active">
                        <i class="fas fa-id-card"></i>
                        <span>Access Pass</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="qr-rfid.html" class="nav-link">
                        <i class="fas fa-qrcode"></i>
                        <span>QR/RFID</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="gatekeeper.html" class="nav-link">
                        <i class="fas fa-shield-alt"></i>
                        <span>Gatekeeper</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="guard-dashboard.html" class="nav-link">
                        <i class="fas fa-user-shield"></i>
                        <span>Guard Panel</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="incident-reports.html" class="nav-link">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Incidents</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="report-categories.html" class="nav-link">
                        <i class="fas fa-folder-open"></i>
                        <span>Categories</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="ticket-status.html" class="nav-link">
                        <i class="fas fa-ticket-alt"></i>
                        <span>Tickets</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="emergency-updates.html" class="nav-link">
                        <i class="fas fa-bell"></i>
                        <span>Emergency</span>
                    </a>
                </li>
            </ul>
        </nav>

        <main class="main-content">
            <div class="page-header">
                <h2>Access Pass Generation</h2>
                <p>Generate temporary and permanent access passes with QR codes</p>
                <a href="index.html" class="btn btn-outline">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </a>
            </div>

            <div style="background: white; border-radius: 16px; padding: 2rem; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08); margin-bottom: 2rem;">
                <h3>Generate New Access Pass</h3>
                <p style="color: #6b7280; margin-bottom: 2rem;">Choose the type of access pass you want to generate</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div onclick="openPassForm('temporary')" style="border: 2px solid var(--primary); background: var(--primary-light); border-radius: 16px; padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                        <div style="font-size: 3rem; color: var(--primary); margin-bottom: 1rem;">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h4 style="margin-bottom: 0.5rem;">Temporary Pass</h4>
                        <p style="color: #6b7280; margin-bottom: 1rem;">Limited time access for visitors, contractors, and temporary personnel</p>
                        <div class="btn btn-primary" style="pointer-events: none;">
                            <i class="fas fa-plus"></i> Create Temporary Pass
                        </div>
                    </div>
                    <div onclick="openPassForm('permanent')" style="border: 2px solid var(--secondary); background: var(--secondary-light); border-radius: 16px; padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                        <div style="font-size: 3rem; color: var(--secondary); margin-bottom: 1rem;">
                            <i class="fas fa-id-badge"></i>
                        </div>
                        <h4 style="margin-bottom: 0.5rem;">Permanent Pass</h4>
                        <p style="color: #6b7280; margin-bottom: 1rem;">Long-term access for employees, residents, and regular personnel</p>
                        <div class="btn btn-secondary" style="pointer-events: none;">
                            <i class="fas fa-plus"></i> Create Permanent Pass
                        </div>
                    </div>
                </div>
            </div>

            <div style="background: white; border-radius: 16px; padding: 2rem; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);">
                <h3>Active Access Passes</h3>
                <div id="activePassesList">
                    <div style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; display: grid; grid-template-columns: auto 1fr auto; gap: 1rem; align-items: center;">
                        <div style="width: 80px; height: 80px; border-radius: 8px; background: #f3f4f6; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-qrcode" style="font-size: 2rem; color: #6b7280;"></i>
                        </div>
                        <div>
                            <h4>John Contractor</h4>
                            <p><strong>ID:</strong> PASS-001 | <strong>Type:</strong> contractor</p>
                            <p><strong>Phone:</strong> +63-917-111-2222</p>
                            <p><strong>Valid Until:</strong> 2024-03-20 18:00</p>
                        </div>
                        <div>
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <span style="padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; background: var(--secondary-light); color: var(--secondary-dark);">Active</span>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-sm btn-secondary">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="btn btn-sm btn-secondary">
                                    <i class="fas fa-print"></i>
                                </button>
                                <button class="btn btn-sm btn-danger">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Pass Form Modal -->
    <div id="passFormModal" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.6); z-index: 10000; align-items: center; justify-content: center; display: none;">
        <div style="background: white; border-radius: 16px; max-width: 800px; width: 95%; max-height: 95vh; overflow-y: auto; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);">
            <div id="formModalHeader" style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; padding: 1.5rem 2rem; border-radius: 16px 16px 0 0; display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 1.25rem; font-weight: 600;">
                    <i id="formModalIcon" class="fas fa-clock"></i> <span id="formModalTitle">Create Temporary Pass</span>
                </div>
                <button onclick="closeFormModal()" style="background: rgba(255, 255, 255, 0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">&times;</button>
            </div>
            <div style="padding: 2rem;">
                <form id="passForm" onsubmit="generatePass(event)">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                        <div class="form-group">
                            <label class="form-label">Full Name *</label>
                            <input type="text" class="form-control" id="passName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number *</label>
                            <input type="tel" class="form-control" id="passPhone" required>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                        <div class="form-group">
                            <label class="form-label">Unit/Department</label>
                            <input type="text" class="form-control" id="passUnit">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pass Category</label>
                            <select class="form-control" id="passCategory">
                                <option value="visitor">Visitor</option>
                                <option value="contractor">Contractor</option>
                                <option value="delivery">Delivery</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="emergency">Emergency</option>
                            </select>
                        </div>
                    </div>

                    <div id="temporaryFields">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                            <div class="form-group">
                                <label class="form-label">Valid From *</label>
                                <input type="datetime-local" class="form-control" id="passValidFrom" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Valid Until *</label>
                                <input type="datetime-local" class="form-control" id="passValidUntil" required>
                            </div>
                        </div>
                    </div>

                    <div id="permanentFields" style="display: none;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                            <div class="form-group">
                                <label class="form-label">Employee ID</label>
                                <input type="text" class="form-control" id="passEmployeeId">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Access Level</label>
                                <select class="form-control" id="passAccessLevel">
                                    <option value="basic">Basic Access</option>
                                    <option value="extended">Extended Access</option>
                                    <option value="full">Full Access</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <div class="form-group">
                            <label class="form-label">Purpose/Notes</label>
                            <textarea class="form-control" id="passPurpose" rows="4" placeholder="Enter the purpose of visit or additional notes..."></textarea>
                        </div>
                    </div>

                    <div class="form-actions" style="display: flex; gap: 1rem; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeFormModal()">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <button type="button" class="btn btn-outline" onclick="resetForm()">
                            <i class="fas fa-redo"></i> Reset Form
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-qrcode"></i> Generate Access Pass
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Pass Generated Modal -->
    <div id="passModal" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.6); z-index: 10000; align-items: center; justify-content: center; display: none;">
        <div style="background: white; border-radius: 16px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);">
            <div style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; padding: 1.5rem 2rem; border-radius: 16px 16px 0 0; display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 1.25rem; font-weight: 600;">
                    <i class="fas fa-check-circle"></i> Access Pass Generated
                </div>
                <button onclick="closeModal()" style="background: rgba(255, 255, 255, 0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">&times;</button>
            </div>
            <div style="padding: 2rem;">
                <div style="text-align: center; padding: 2rem; border: 2px dashed #e5e7eb; border-radius: 12px; margin-bottom: 1.5rem;">
                    <div id="qrCodeContainer" style="width: 200px; height: 200px; margin: 0 auto 1rem; border-radius: 8px; background: #f3f4f6;"></div>
                    <div id="passInfo">
                        <h4>Sample Pass</h4>
                        <p><strong>Pass ID:</strong> PASS-123456</p>
                        <p><strong>Type:</strong> Temporary</p>
                        <p><strong>Category:</strong> Visitor</p>
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn btn-secondary">
                        <i class="fas fa-download"></i> Download
                    </button>
                    <button class="btn btn-secondary">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button class="btn btn-primary" onclick="closeModal()">Done</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        var currentType = 'temporary';

        function openPassForm(type) {
            currentType = type;
            
            var modalIcon = document.getElementById('formModalIcon');
            var modalTitle = document.getElementById('formModalTitle');
            var modalHeader = document.getElementById('formModalHeader');
            var tempFields = document.getElementById('temporaryFields');
            var permFields = document.getElementById('permanentFields');

            if (type === 'temporary') {
                modalIcon.className = 'fas fa-clock';
                modalTitle.textContent = 'Create Temporary Pass';
                modalHeader.style.background = 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)';
                tempFields.style.display = 'block';
                permFields.style.display = 'none';
            } else {
                modalIcon.className = 'fas fa-id-badge';
                modalTitle.textContent = 'Create Permanent Pass';
                modalHeader.style.background = 'linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%)';
                tempFields.style.display = 'none';
                permFields.style.display = 'block';
            }

            document.getElementById('passFormModal').style.display = 'flex';
        }

        function closeFormModal() {
            document.getElementById('passFormModal').style.display = 'none';
        }

        function generatePass(event) {
            event.preventDefault();
            
            var name = document.getElementById('passName').value;
            var phone = document.getElementById('passPhone').value;
            
            if (!name || !phone) {
                alert('Please fill in required fields');
                return;
            }

            var passId = 'PASS-' + Date.now().toString().substr(-6);
            var unit = document.getElementById('passUnit').value;
            var category = document.getElementById('passCategory').value;
            var purpose = document.getElementById('passPurpose').value;
            
            // Close form modal
            closeFormModal();
            
            // Generate QR Code
            document.getElementById('qrCodeContainer').innerHTML = '';
            
            var qrData = passId + '|' + name + '|' + phone + '|' + currentType + '|' + category;
            if (currentType === 'temporary') {
                var validFrom = document.getElementById('passValidFrom').value;
                var validUntil = document.getElementById('passValidUntil').value;
                qrData += '|' + validFrom + '|' + validUntil;
            }
            
            try {
                new QRCode(document.getElementById('qrCodeContainer'), {
                    text: qrData,
                    width: 200,
                    height: 200,
                    colorDark: '#000000',
                    colorLight: '#ffffff'
                });
            } catch (e) {
                document.getElementById('qrCodeContainer').innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 200px;"><i class="fas fa-qrcode" style="font-size: 4rem; color: #6b7280;"></i></div>';
            }

            // Update pass info
            var passInfoHtml = '<h4>' + name + '</h4>' +
                '<p><strong>Pass ID:</strong> ' + passId + '</p>' +
                '<p><strong>Type:</strong> ' + currentType.charAt(0).toUpperCase() + currentType.slice(1) + '</p>' +
                '<p><strong>Category:</strong> ' + category.charAt(0).toUpperCase() + category.slice(1) + '</p>' +
                '<p><strong>Phone:</strong> ' + phone + '</p>';
                
            if (unit) {
                passInfoHtml += '<p><strong>Unit:</strong> ' + unit + '</p>';
            }
            
            if (currentType === 'temporary') {
                var validFrom = document.getElementById('passValidFrom').value;
                var validUntil = document.getElementById('passValidUntil').value;
                passInfoHtml += '<p><strong>Valid:</strong> ' + validFrom + ' to ' + validUntil + '</p>';
            }

            document.getElementById('passInfo').innerHTML = passInfoHtml;
            document.getElementById('passModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('passModal').style.display = 'none';
        }

        function resetForm() {
            document.getElementById('passForm').reset();
            // Reset to temporary type
            currentType = 'temporary';
            var modalIcon = document.getElementById('formModalIcon');
            var modalTitle = document.getElementById('formModalTitle');
            var modalHeader = document.getElementById('formModalHeader');
            var tempFields = document.getElementById('temporaryFields');
            var permFields = document.getElementById('permanentFields');

            modalIcon.className = 'fas fa-clock';
            modalTitle.textContent = 'Create Temporary Pass';
            modalHeader.style.background = 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)';
            tempFields.style.display = 'block';
            permFields.style.display = 'none';
        }

        window.onclick = function(event) {
            var passModal = document.getElementById('passModal');
            var formModal = document.getElementById('passFormModal');
            
            if (event.target === passModal) {
                closeModal();
            }
            if (event.target === formModal) {
                closeFormModal();
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            var now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('passValidFrom').value = now.toISOString().slice(0, 16);
            
            var tomorrow = new Date(now.getTime() + 24 * 60 * 60 * 1000);
            document.getElementById('passValidUntil').value = tomorrow.toISOString().slice(0, 16);
        });
    </script>
</body>
</html> 